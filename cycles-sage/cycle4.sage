#################
#### Fields #####
#################

p=2^377-12351
Fp=GF(p)
Rp.<x>=Fp[]
Fp2.<lam> = Fp.extension(x^2-3,'x') 
r=4
Fp2r.<mu> = Fp.extension(x^(2*r)-3, 'x')

q=p^4-p^2+1
Fq=GF(q)
Rq.<x>=Fq[]
Fq2.<xi> = Fq.extension(x^2+11,'x')

#################
## Construct A ##
#################

alpha=lam+6
E=EllipticCurve(Fp2,[0,0,0,0,alpha])
assert (p^2+p+1)*E.random_point() == E(0)

Er=EllipticCurve(Fp2r,[0,0,0,0,mu^r+3]) #mu^(2*r)=3 --> mu^r=lam
(p^4+p^2+1)*(p^4-p^2+1)*Er.random_point() == Er(0)

#################
## Construct B ##
#################

a=5218061725854579019747928477539484109362350516204683336691651077355425175398944362510380865554200419727033505658726606638962106785912231016605416917586532577483051724081987236495164664228142687673543863579048479304044383185047331096125967688090468355236143108846387499900159215506708207271673976461015007086999327757602541147010460017757279121852683684371147837452840560542039993717060028690802022532478445184467653151030895605600240589934803593520619376*xi + 8012791933783277493139526690950802203986966097665390270439945301470536030532563470614990268024797500128473032691722610482796488633110767938885814710261562897322540740619714900282272158011073731341580635970318833684581077903249391226542544955724215744271327924707043387497972253174717977498762746949120529648218609465739628711689314141787891625012971702566348993219431145467007527265232845545432795371974385866309133513376428653662287803439007348484540912 
b=7008826609881859639643982569035279017073140675154756822404200291459359483618150459961935324581605646246394558580784625600615640015235270253703166883611919134022879316128753926482501249785497866386622209722430409957405544335673903363256467619222778251989745879720549676696199955753094546164912238727030005812102503365153421577452873933744655396673500117079730664831540777539397086036181182776038768099377174320669844915840999735999986938552593415201854062*xi + 5032601492095349622021554704666726933815165312339630259693968209499127352238500654226436773749932753788400349861859238320037161718415476591340128821108768166836730533422565329782009899764573402269618473182257616290770362215766146869746261336730258707837304495204912533181479258440184161594246804429526155474443695554500125525168424789910991015835796168173648079120012924504579459616076721744737594617877047719682562852198639928090890483085791078578077305

B=EllipticCurve(Fq2,[0,0,0,a,b])
N= (p^2-1)^2*p^4
assert N*B.random_point() == B(0)
