clear;

/////////////////
//// Fields /////
/////////////////

p:=2^512-258887;
Fp:=GF(p);
Fp2<lambda>:=ExtensionField<Fp,x|x^2-3>;
r:=4;
Fp2r<mu>:=ExtensionField<Fp2,x|x^r-lambda>;

q:=p^4-p^2+1;
Fq:=GF(q);
Fq2<xi>:=ExtensionField<Fq,x|x^2+7>;

/////////////////
// Construct A //
/////////////////

alpha:=lambda+3;
E:=EllipticCurve([Fp2|0,alpha]);
assert (p^2+p+1)*Random(E) eq E!0;

Er:=BaseChange(E,Fp2r);
assert (p^4+p^2+1)*(p^4-p^2+1)*Random(Er) eq Er!0;

/////////////////
// Construct B //
/////////////////

a:=16953249918166719491415589530582799419558985582206762728135234263437652329458647977587278388646410085097172477185242689328487151968224845298768076085405997749330804753803601944843711395280263471131064634245124519181041084245108997071135270303157035068370660861876242706836811185172688335299141864319070294671209566463983358429590520040058131012561193143056268116052528699913297453686967885547125668802140980429207664651016640446778019882451951884093248648172459375463124862724238155996209219296845328954490283821249830323730694285053024214988768653416497027851367775078093050339636783406848675050535100851730881524000*xi + 24847929131758142015079583935476815425033369142883858165661913047560361584124112483145331855263844468639640226157191623121377426895427958280982781983136053083981533210278627783399760775917086249090470671860183889019155913861091398108772589706956180634479653050127244182341824231118222138028611092302060803530187889742142166681885633132200405535300056894258502828942619871467177307305036897189225925781301222473881991649905734737489961424181075798403242718095914511381162587604729845713647185189553808014510079405539741725932537533824737903524326179268218773898368736107147906648821333723993599225211959973181834105192;
b:=16731906337622553359553923308406861940764497009584068702280642286874255030225037506270971176615374868417564379647027600998200100786185255178212808851108998588777842076369353851323535734870688116532305225907223996081486087274140185873648166640985153854744893712033054523696059853516556341315428195145811820851822992032291451469544192160863455528186120992753760476330543818986264721782656380955932157498359575692473502646306070563460421503031509449490711678806542770063303034842137749790074760788224867679333675859380205273257238005421136873625001793117349363053252047763007426377111981383343018007341149538159118102582*xi + 10426217408428049232229559964699656435641180745460214468918754017019610201533176114218754211050854267451797572868543763711607172670281935804452171862364917503190478764303371482070108478072041629834546043857292111024790369409307875923230760160631900787161354174459304636987239124812389444821902884187353691419768103005091557236355687168263912133164961387308732965053640016556453736333726919377252982919909435577053918813605164158298402701022917878033649700126378447339170771373171002386821993281875472733339361377336764366758494984043453751469878910595334175196313391883069682240698860674501573694974414922093270288449;

B:=EllipticCurve([Fq2|a,b]);
N:= (p^2-1)^2*p^4;
assert N*Random(B) eq B!0;

